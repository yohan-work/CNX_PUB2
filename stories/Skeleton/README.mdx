import { Meta } from '@storybook/blocks';

<Meta title="Components/Skeleton/Guide" />

# Skeleton 컴포넌트

로딩 상태를 표시하는 스켈레톤 컴포넌트입니다. Material UI와 Tailwind CSS의 Flowbite를 참고하여 구현되었습니다.

## 기능

- 4가지의 기본 요소를 조합 (text, circular, rectangular, rounded)
- 다크/라이트 테마 지원
- 9가지 애니메이션 효과 (wave, pulse, shine, glow, fade, gradient, slide, shimmer)
- 애니메이션 속도 조절 가능

## 속성

### 테마 (theme)
- `light`: 라이트 테마 (기본값)
- `dark`: 다크 테마

### 애니메이션 (animation)
- `wave`: 물결 효과 (기본값)
- `pulse`: 펄스 효과 - 투명도 변화로 깜빡이는 효과
- `shine`: 반짝임 효과 - 빛이 지나가는 효과
- `glow`: 발광 효과 - box-shadow를 사용한 빛나는 효과
- `fade`: 페이드 효과 - 투명도 변화로 페이드 인/아웃
- `gradient`: 그라데이션 효과 - 여러 색상의 그라데이션 움직임
- `slide`: 슬라이딩 효과 - 빛이 지나가는 효과
- `shimmer`: 부드러운 반짝임 효과 - 그라데이션을 사용한 부드러운 빛 효과

### 애니메이션 속도 (animationSpeed)
- 기본값: 1.5초

## 스타일 변수

```css
:root {
    --skeleton-bg-light: #e0e0e0;
    --skeleton-bg-dark: #333;
    --card-bg-light: #fff;
    --card-bg-dark: #1e1e1e;
    --animation-duration: 1.5s;
}
```

### 기본 구조
```css
.skeleton {
    background-color: var(--skeleton-bg-light);
    border-radius: 4px;
    margin: 10px 0;
}

.dark-theme .skeleton {
    background-color: var(--skeleton-bg-dark);
}
```
- 모든 스켈레톤의 기본 스타일
- 다크 테마 지원

## 기본 요소

### Text
```css
.text {
    height: 20px;
    width: 200px;
}
```
- 높이: 20px
- 너비: 200px
- 텍스트 형태의 스켈레톤을 표시할 때 사용

### Circular
```css
.circular {
    width: 40px;
    height: 40px;
    border-radius: 50%;
}
```
- 너비: 40px
- 높이: 40px
- 완전한 원형 스켈레톤을 표시할 때 사용
- `border-radius: 50%`로 원형 모양 구현

### Rectangular
```css
.rectangular {
    width: 200px;
    height: 100px;
}
```
- 너비: 200px
- 높이: 100px
- 직사각형 형태의 스켈레톤을 표시할 때 사용

### Rounded
```css
.rounded {
    width: 200px;
    height: 100px;
    border-radius: 8px;
}
```
- 너비: 200px
- 높이: 100px
- `border-radius: 8px`로 모서리가 둥근 직사각형 스켈레톤을 표시할 때 사용

## 애니메이션

### Wave
```css
.skeleton-wave {
    background: linear-gradient(
        90deg,
        var(--skeleton-bg-light) 25%,
        rgba(224, 224, 224, 0.5) 50%,
        var(--skeleton-bg-light) 75%
    );
    background-size: 200% 100%;
    animation: skeleton-wave var(--animation-duration) infinite linear;
}

@keyframes skeleton-wave {
    0% {
        background-position: 200% 0;
    }
    100% {
        background-position: -200% 0;
    }
}
```
- 물결 효과를 주는 애니메이션
- 그라데이션을 사용하여 움직이는 효과 구현
- 기본 애니메이션 속도: 1.5초

### Pulse
```css
.skeleton-pulse {
    animation: skeleton-pulse var(--animation-duration) infinite;
}

@keyframes skeleton-pulse {
    0%, 100% {
        opacity: 1;
    }
    50% {
        opacity: 0.5;
    }
}
```
- 펄스 효과를 주는 애니메이션
- 투명도 변화로 깜빡이는 효과 구현
- 기본 애니메이션 속도: 1.5초

### Shine
```css
.skeleton-shine {
    position: relative;
    overflow: hidden;
}

.skeleton-shine::after {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(
        90deg,
        transparent,
        rgba(255, 255, 255, 0.3),
        transparent
    );
    animation: skeleton-shine var(--animation-duration) infinite;
}

@keyframes skeleton-shine {
    0% {
        left: -100%;
    }
    100% {
        left: 100%;
    }
}
```
- 반짝이는 효과를 주는 애니메이션
- 가상 요소를 사용하여 빛이 지나가는 효과 구현
- 기본 애니메이션 속도: 1.5초

### Glow
```css
.skeleton-glow {
    animation: skeleton-glow var(--animation-duration) infinite;
}

@keyframes skeleton-glow {
    0%, 100% {
        box-shadow: 0 0 5px rgba(255, 255, 255, 0.5);
    }
    50% {
        box-shadow: 0 0 20px rgba(255, 255, 255, 0.8);
    }
}
```
- 발광 효과를 주는 애니메이션
- box-shadow를 사용하여 빛나는 효과 구현
- 기본 애니메이션 속도: 1.5초

### Fade
```css
.skeleton-fade {
    animation: skeleton-fade var(--animation-duration) infinite;
}

@keyframes skeleton-fade {
    0% {
        opacity: 0.3;
    }
    50% {
        opacity: 1;
    }
    100% {
        opacity: 0.3;
    }
}
```
- 페이드 효과를 주는 애니메이션
- 투명도 변화로 페이드 인/아웃 효과 구현
- 기본 애니메이션 속도: 1.5초

### Gradient
```css
.skeleton-gradient {
    background: linear-gradient(
        90deg,
        var(--skeleton-bg-light) 0%,
        rgba(224, 224, 224, 0.8) 25%,
        var(--skeleton-bg-light) 50%,
        rgba(224, 224, 224, 0.8) 75%,
        var(--skeleton-bg-light) 100%
    );
    background-size: 200% 100%;
    animation: skeleton-gradient var(--animation-duration) infinite linear;
}

@keyframes skeleton-gradient {
    0% {
        background-position: 200% 0;
    }
    100% {
        background-position: -200% 0;
    }
}
```
- 그라데이션이 움직이는 효과를 주는 애니메이션
- 여러 색상의 그라데이션을 사용하여 부드러운 움직임 구현
- 기본 애니메이션 속도: 1.5초

### Slide
```css
.skeleton-slide {
    position: relative;
    overflow: hidden;
}

.skeleton-slide::after {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(
        90deg,
        transparent,
        rgba(255, 255, 255, 0.5),
        transparent
    );
    animation: skeleton-slide var(--animation-duration) infinite;
}

@keyframes skeleton-slide {
    0% {
        left: -100%;
    }
    100% {
        left: 100%;
    }
}
```
- 슬라이딩 효과를 주는 애니메이션
- 가상 요소를 사용하여 빛이 지나가는 효과 구현
- 기본 애니메이션 속도: 1.5초

### Shimmer
```css
.skeleton-shimmer {
    position: relative;
    overflow: hidden;
}

.skeleton-shimmer::after {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(
        90deg,
        transparent,
        rgba(255, 255, 255, 0.7),
        transparent
    );
    animation: skeleton-shimmer var(--animation-duration) infinite;
}

@keyframes skeleton-shimmer {
    0% {
        left: -100%;
    }
    100% {
        left: 100%;
    }
}
```
- 부드러운 반짝임 효과를 주는 애니메이션
- 가상 요소와 그라데이션을 사용하여 부드러운 빛 효과 구현
- 기본 애니메이션 속도: 1.5초

## 컴포넌트 구조

Skeleton 컴포넌트는 4가지 기본 요소(text, circular, rectangular, rounded)를 조합하여 다양한 형태의 스켈레톤을 구현합니다. 각 기본 요소는 독립적으로 사용할 수 있으며, 부모 요소를 통해 추가적인 스타일을 정의하여 다양한 컴포넌트를 만들 수 있습니다.

## 컴포넌트 예시

### 기본 스켈레톤
```html
<div class="skeleton-section" role="status" aria-live="polite" aria-label="로딩 중">
    <div class="skeleton text skeleton-wave"></div>
    <div class="skeleton circular skeleton-wave"></div>
    <div class="skeleton rectangular skeleton-wave"></div>
    <div class="skeleton rounded skeleton-wave"></div>
</div>
```

```css
.skeleton {
    background-color: var(--skeleton-bg-light);
    border-radius: 4px;
    margin: 10px 0;
}

.dark-theme .skeleton {
    background-color: var(--skeleton-bg-dark);
}

.text {
    height: 20px;
    width: 200px;
}

.circular {
    width: 40px;
    height: 40px;
    border-radius: 50%;
}

.rectangular {
    width: 200px;
    height: 100px;
}

.rounded {
    width: 200px;
    height: 100px;
    border-radius: 8px;
}
```

### 카드 스켈레톤
```html
<div class="skeleton-section" role="status" aria-live="polite" aria-label="로딩 중">
    <div class="skeleton-card">
        <div class="skeleton rectangular skeleton-wave"></div>
        <div class="skeleton-card-content">
            <div class="skeleton text skeleton-wave"></div>
            <div class="skeleton text skeleton-wave" style="width: 60%"></div>
        </div>
    </div>
</div>
```

```css
.skeleton-card {
    width: 345px;
    padding: 16px;
    background: var(--card-bg-light);
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.dark-theme .skeleton-card {
    background: var(--card-bg-dark);
}

.skeleton-card .rectangular {
    width: 100%;
    height: 140px;
}

.skeleton-card-content {
    margin-top: 16px;
}
```

### 프로필 스켈레톤
```html
<div class="skeleton-section" role="status" aria-live="polite" aria-label="로딩 중">
    <div class="skeleton-profile">
        <div class="skeleton circular skeleton-wave"></div>
        <div class="skeleton-profile-content">
            <div class="skeleton text skeleton-wave"></div>
            <div class="skeleton text skeleton-wave" style="width: 60%"></div>
        </div>
    </div>
</div>
```

```css
.skeleton-profile {
    display: flex;
    align-items: center;
    gap: 16px;
    width: 300px;
}

.skeleton-profile-content {
    flex: 1;
}

.skeleton-profile .circular {
    width: 40px;
    height: 40px;
}
```

### 미디어 스켈레톤
```html
<div class="skeleton-section" role="status" aria-live="polite" aria-label="로딩 중">
    <div class="skeleton-media">
        <div class="skeleton-media-header">
            <div class="skeleton-media-avatar">
                <div class="skeleton circular skeleton-wave"></div>
            </div>
            <div class="skeleton-media-content">
                <div class="skeleton text skeleton-wave skeleton-media-title"></div>
                <div class="skeleton text skeleton-wave" style="width: 60%"></div>
            </div>
        </div>
        <div class="skeleton rectangular skeleton-wave"></div>
        <div class="skeleton-media-body">
            <div class="skeleton text skeleton-wave"></div>
            <div class="skeleton text skeleton-wave" style="width: 60%"></div>
            <div class="skeleton text skeleton-wave" style="width: 40%"></div>
        </div>
    </div>
</div>
```

```css
.skeleton-media {
    width: 100%;
    max-width: 345px;
    background: var(--card-bg-light);
    border-radius: 4px;
    overflow: hidden;
    box-shadow: 0px 2px 1px -1px rgba(0,0,0,0.2),
                0px 1px 1px 0px rgba(0,0,0,0.14),
                0px 1px 3px 0px rgba(0,0,0,0.12);
}

.dark-theme .skeleton-media {
    background: var(--card-bg-dark);
}

.skeleton-media-header {
    display: flex;
    align-items: flex-start;
    padding: 16px;
}

.skeleton-media-avatar {
    margin-right: 16px;
    flex-shrink: 0;
}

.skeleton-media-content {
    flex: 1;
    min-width: 0;
}

.skeleton-media-title {
    margin-bottom: 6px;
}

.skeleton-media .rectangular {
    width: 100%;
    height: 190px;
    margin: 0;
    border-radius: 0;
}

.skeleton-media-body {
    padding: 16px;
}

.skeleton-media-body .text {
    height: 10px;
    margin-bottom: 6px;
}
```

## 스크린 리더 접근성 가이드

### 로딩 상태와 실제 데이터 전환

스켈레톤 UI에서 실제 데이터로 전환될 때 스크린 리더가 적절하게 콘텐츠를 읽어주도록 하기 위한 가이드입니다.

#### 1. 기본 구조
```html
<!-- 로딩 중 -->
<div class="skeleton-section" role="status" aria-live="polite" aria-label="게시글 로딩 중">
    <div class="skeleton-media">
        <div class="skeleton text skeleton-wave"></div>
        <div class="skeleton rectangular skeleton-wave"></div>
    </div>
</div>

<!-- 로딩 완료 -->
<div class="skeleton-section">
    <div class="content">
        <h2>게시글 제목</h2>
        <p>게시글 내용</p>
    </div>
</div>
```

#### 2. ARIA 속성 적용 위치

1. **로딩 중 상태**
   - `role="status"`: 전체 섹션의 상태를 나타냅니다.
   - `aria-live="polite"`: 콘텐츠 변경을 적절한 시점에 알립니다.
   - `aria-label`: 현재 상태를 명확하게 설명합니다.

2. **로딩 완료 후**
   - 상태 관련 ARIA 속성(`role="status"`, `aria-live="polite"`)을 제거합니다.
   - 일반 콘텐츠로 처리하여 스크린 리더가 자연스럽게 읽도록 합니다.
   - 콘텐츠 자체의 의미 있는 구조(헤딩 등)를 통해 정보를 전달합니다.

#### 3. 속성 제거의 이점

1. **자연스러운 콘텐츠 흐름**
   - 일반 콘텐츠는 스크린 리더가 문서 순서대로 읽는 것이 자연스럽습니다.
   - `role="status"`가 없으면 실제 콘텐츠의 구조대로 읽게 됩니다.

2. **중복 알림 방지**
   - 로딩이 완료된 후에는 별도의 알림이 필요하지 않습니다.
   - 콘텐츠 자체가 이미 충분한 정보를 제공합니다.

3. **스크린 리더 사용자 경험 개선**
   - 불필요한 알림은 사용자 경험을 방해할 수 있습니다.
   - 실제 콘텐츠는 일반적인 탐색 방식으로 접근하는 것이 더 직관적입니다.

#### 4. 스크린 리더 동작 시나리오

1. **초기 로딩 상태**
   - 스크린 리더: "게시글 로딩 중"
   - 사용자는 콘텐츠가 로딩 중임을 인지

2. **데이터 로드 완료**
   - 스켈레톤 UI가 제거되고 실제 콘텐츠로 대체됨
   - 스크린 리더는 새롭게 추가된 콘텐츠를 일반적인 방식으로 읽기 시작
   - 예: "게시글 제목" (헤딩), "게시글 내용" (텍스트) 등

### 실제 사용 예시

```html
<!-- 로딩 중 -->
<div class="skeleton-section" role="status" aria-live="polite" aria-label="게시글 로딩 중">
    <div class="skeleton-media">
        <div class="skeleton text skeleton-wave"></div>
        <div class="skeleton rectangular skeleton-wave"></div>
    </div>
</div>

<!-- 로딩 완료 -->
<div class="skeleton-section">
    <div class="content">
        <h2>스켈레톤 UI 접근성 가이드</h2>
        <p>스켈레톤 UI에서 실제 데이터로 전환될 때 스크린 리더가 적절하게 콘텐츠를 읽어주도록 하기 위한 가이드입니다.</p>
    </div>
</div>
```

### 구현 방법

```javascript
function updateContent(isLoading, data) {
    const container = document.querySelector('.skeleton-section');
    
    if (isLoading) {
        // 로딩 중 상태 설정
        container.setAttribute('role', 'status');
        container.setAttribute('aria-live', 'polite');
        container.setAttribute('aria-label', '게시글 로딩 중');
        
        // 스켈레톤 UI 렌더링
        container.innerHTML = `
            <div class="skeleton-media">
                <div class="skeleton text skeleton-wave"></div>
                <div class="skeleton rectangular skeleton-wave"></div>
            </div>
        `;
    } else {
        // 로딩 완료 후 상태 속성 제거
        container.removeAttribute('role');
        container.removeAttribute('aria-live');
        container.removeAttribute('aria-label');
        
        // 실제 콘텐츠 렌더링
        container.innerHTML = `
            <div class="content">
                <h2>${data.title}</h2>
                <p>${data.content}</p>
            </div>
        `;
    }
}
```

### 권장사항

1. **명확한 상태 전환**
   - 로딩 중에만 상태 관련 속성을 사용합니다.
   - 로딩 완료 후에는 상태 관련 속성을 제거합니다.

2. **성능 고려**
   - 스크린 리더 알림이 사용자 경험을 방해하지 않도록 합니다.
   - 필요한 경우에만 상태 변경 알림을 제공합니다.

### 주의사항

1. **중복 알림 방지**
   - 자식 요소에 `role="status"`를 사용하지 않습니다.
   - 최상위 컨테이너에만 상태 관련 속성을 적용합니다.

## 스켈레톤 UI 최적화 가이드

### 최소 노출 시간 설정

스켈레톤 UI는 200ms 이상의 로딩 시간이 예상될 때만 표시하는 것이 좋습니다. 이는 다음과 같은 이유 때문입니다:

1. **사용자 경험 최적화**
   - 200ms 미만의 빠른 로딩에서는 스켈레톤 UI가 깜빡임(Flash) 현상을 일으킬 수 있습니다.
   - 이는 오히려 사용자 경험을 저하시킬 수 있습니다.

2. **성능 고려**
   ```javascript
   // 최소 노출 시간 설정 예시
   const MIN_LOADING_TIME = 200; // ms
   
   function showSkeleton() {
       const startTime = performance.now();
       
       // 데이터 로딩 시작
       loadData().then(() => {
           const endTime = performance.now();
           const loadingTime = endTime - startTime;
           
           if (loadingTime >= MIN_LOADING_TIME) {
               // 스켈레톤 UI 표시
               showSkeletonUI();
           }
       });
   }
   ```

3. **시각적 일관성**
   - 200ms 미만의 빠른 로딩에서는 실제 콘텐츠가 바로 표시되는 것이 더 자연스럽습니다.
   - 스켈레톤 UI의 깜빡임을 방지하여 시각적 일관성을 유지합니다.

### 권장 구현 방식

1. **타이머 기반 구현**
   ```javascript
   let skeletonTimer = null;
   
   function startLoading() {
       // 200ms 후에 스켈레톤 UI 표시
       skeletonTimer = setTimeout(() => {
           showSkeletonUI();
       }, 200);
       
       // 데이터 로딩 시작
       loadData().then(() => {
           // 타이머가 아직 실행 중이면 취소
           if (skeletonTimer) {
               clearTimeout(skeletonTimer);
               skeletonTimer = null;
           }
       });
   }
   ```

2. **CSS 트랜지션 활용**
   ```css
   .skeleton {
       opacity: 0;
       transition: opacity 0.2s ease-in-out;
   }
   
   .skeleton.show {
       opacity: 1;
   }
   ```

### 주의사항

1. **네트워크 상태 고려**
   - 네트워크 상태가 좋을 때는 스켈레톤 UI가 필요하지 않을 수 있습니다.
   - 네트워크 상태에 따라 동적으로 최소 노출 시간을 조정할 수 있습니다.

2. **캐시된 콘텐츠 처리**
   - 캐시된 콘텐츠의 경우 즉시 표시하는 것이 좋습니다.
   - 스켈레톤 UI를 표시하지 않고 바로 실제 콘텐츠를 보여줍니다.

3. **점진적 로딩**
   - 큰 콘텐츠의 경우 점진적으로 로딩하는 것이 좋습니다.
   - 각 섹션별로 독립적인 스켈레톤 UI를 사용할 수 있습니다.

## 참고 자료
- [Material UI Skeleton](https://mui.com/material-ui/react-skeleton/#pulsate-example)
- [Flowbite Skeleton](https://flowbite.com/docs/components/skeleton/)
- [kakopay tech Skeleton](https://tech.kakaopay.com/post/skeleton-ui-idea/)